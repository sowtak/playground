import{c as h,a as g,g as y,d as E}from"../common/index-6d34a73c.js";function b(s,n,c){const l=s.value,o=n+(c||""),r=document.activeElement;let t=0,e=0;for(;t<l.length&&t<o.length&&l[t]===o[t];)t++;for(;l.length-e-1>=0&&o.length-e-1>=0&&l[l.length-e-1]===o[o.length-e-1];)e++;t=Math.min(t,Math.min(l.length,o.length)-e),s.setSelectionRange(t,l.length-e);const i=o.substring(t,o.length-e);if(s.focus(),!document.execCommand("insertText",!1,i)){s.value=o;const a=document.createEvent("Event");a.initEvent("input",!0,!0),s.dispatchEvent(a)}return s.setSelectionRange(n.length,n.length),r.focus(),s}function _(s,n,c){const l=s.selectionEnd,o=s.value.substr(0,s.selectionStart)+n,r=s.value.substring(s.selectionStart,l)+(c||"")+s.value.substr(l);return b(s,o,r),s.selectionEnd=l+n.length,s}var S=Object.freeze({__proto__:null,update:b,wrapCursor:_}),x=h(function(s){(function(){var n=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],c=typeof window!="undefined",l=c&&window.mozInnerScreenX!=null;function o(r,t,e){if(!c)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var i=e&&e.debug||!1;if(i){var a=document.querySelector("#input-textarea-caret-position-mirror-div");a&&a.parentNode.removeChild(a)}var d=document.createElement("div");d.id="input-textarea-caret-position-mirror-div",document.body.appendChild(d);var u=d.style,f=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,p=r.nodeName==="INPUT";u.whiteSpace="pre-wrap",p||(u.wordWrap="break-word"),u.position="absolute",i||(u.visibility="hidden"),n.forEach(function(m){p&&m==="lineHeight"?u.lineHeight=f.height:u[m]=f[m]}),l?r.scrollHeight>parseInt(f.height)&&(u.overflowY="scroll"):u.overflow="hidden",d.textContent=r.value.substring(0,t),p&&(d.textContent=d.textContent.replace(/\s/g,"\xA0"));var v=document.createElement("span");v.textContent=r.value.substring(t)||".",d.appendChild(v);var w={top:v.offsetTop+parseInt(f.borderTopWidth),left:v.offsetLeft+parseInt(f.borderLeftWidth),height:parseInt(f.lineHeight)};return i?v.style.backgroundColor="#aaa":document.body.removeChild(d),w}s.exports=o})()}),O=h(function(s,n){Object.defineProperty(n,"__esModule",{value:!0}),n.calculateElementOffset=void 0;const c=l=>{const o=l.getBoundingClientRect(),r=l.ownerDocument;if(r==null)throw new Error("Given element does not belong to document");const{defaultView:t,documentElement:e}=r;if(t==null)throw new Error("Given element does not belong to window");const i={top:o.top+t.pageYOffset,left:o.left+t.pageXOffset};return e&&(i.top-=e.clientTop,i.left-=e.clientLeft),i};n.calculateElementOffset=c}),L=h(function(s,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getLineHeightPx=void 0;const c="0".charCodeAt(0),l="9".charCodeAt(0),o=e=>c<=e&&e<=l,r=e=>{const i=getComputedStyle(e),a=i.lineHeight;if(o(a.charCodeAt(0))){const d=parseFloat(a);return o(a.charCodeAt(a.length-1))?d*parseFloat(i.fontSize):d}return t(e.nodeName,i)};n.getLineHeightPx=r;const t=(e,i)=>{const a=document.body;if(!a)return 0;const d=document.createElement(e);d.innerHTML="&nbsp;",Object.assign(d.style,{fontSize:i.fontSize,fontFamily:i.fontFamily,padding:"0"}),a.appendChild(d),d instanceof HTMLTextAreaElement&&(d.rows=1);const u=d.offsetHeight;return a.removeChild(d),u}}),T=h(function(s,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSafari=void 0;const c=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);n.isSafari=c}),C=h(function(s,n){var c=g&&g.__createBinding||(Object.create?function(o,r,t,e){e===void 0&&(e=t),Object.defineProperty(o,e,{enumerable:!0,get:function(){return r[t]}})}:function(o,r,t,e){e===void 0&&(e=t),o[e]=r[t]}),l=g&&g.__exportStar||function(o,r){for(var t in o)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&c(r,o,t)};Object.defineProperty(n,"__esModule",{value:!0}),l(O,n),l(L,n),l(T,n)}),P=y(S),H=h(function(s,n){var c=g&&g.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(n,"__esModule",{value:!0}),n.TextareaEditor=void 0;const l=c(x);class o extends E.Editor{constructor(t){super();this.el=t,this.onInput=()=>{this.emitChangeEvent()},this.onKeydown=e=>{const i=this.getCode(e);let a;i==="UP"||i==="DOWN"?a=this.emitMoveEvent(i):i==="ENTER"?a=this.emitEnterEvent():i==="ESC"&&(a=this.emitEscEvent()),a&&a.defaultPrevented&&e.preventDefault()},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(t){const e=this.getBeforeCursor();if(e!=null){const i=t.replace(e,this.getAfterCursor());this.el.focus(),Array.isArray(i)&&((0,P.update)(this.el,i[0],i[1]),this.el&&this.el.dispatchEvent((0,E.createCustomEvent)("input")))}}getCursorOffset(){const t=(0,C.calculateElementOffset)(this.el),e=this.getElScroll(),i=this.getCursorPosition(),a=(0,C.getLineHeightPx)(this.el),d=t.top-e.top+i.top+a,u=t.left-e.left+i.left,f=this.el.getBoundingClientRect().top;if(this.el.dir!=="rtl")return{top:d,left:u,lineHeight:a,clientTop:f};{const p=document.documentElement?document.documentElement.clientWidth-u:0;return{top:d,right:p,lineHeight:a,clientTop:f}}}getBeforeCursor(){return this.el.selectionStart!==this.el.selectionEnd?null:this.el.value.substring(0,this.el.selectionEnd)}getAfterCursor(){return this.el.value.substring(this.el.selectionEnd)}getElScroll(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}getCursorPosition(){return(0,l.default)(this.el,this.el.selectionEnd)}startListening(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}stopListening(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}n.TextareaEditor=o}),j=h(function(s,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextareaEditor=void 0,Object.defineProperty(n,"TextareaEditor",{enumerable:!0,get:function(){return H.TextareaEditor}})}),A=j.TextareaEditor;export{A as TextareaEditor};
